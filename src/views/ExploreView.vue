<template>
  <PhoneFrame>
    <div class="h-full w-full bg-black flex flex-col relative overflow-hidden">
      <!-- é™æ€èƒŒæ™¯ -->
      <div class="absolute inset-0 bg-gradient-to-br from-gray-900 via-purple-900 to-blue-900 z-0"></div>
      
      <!-- æ¸å˜é®ç½©å±‚ -->
      <div class="absolute inset-0 bg-gradient-to-b from-black/60 via-black/20 to-black/80 z-10"></div>
      
      <!-- å†…å®¹å®¹å™¨ -->
      <div class="relative z-20 h-full flex flex-col text-white">
        <!-- é¡¶éƒ¨å¯¼èˆª -->
        <header class="flex-shrink-0 pt-12 pb-4 px-8 flex items-center justify-between">
          <div class="flex items-center space-x-3">
            <h1 class="text-2xl font-bold tracking-wider">HealthWatch</h1>
            <div class="w-2 h-2 bg-blue-400 rounded-full animate-pulse"></div>
          </div>
          <button @click="handleLogin" class="text-sm bg-white/10 backdrop-blur-sm px-4 py-2 rounded-full border border-white/20 hover:bg-white/20 transition-all">
            ç™»å½•
          </button>
        </header>

        <!-- ä¸»å†…å®¹åŒºåŸŸ - æ¨ªå‘æ»šåŠ¨ -->
        <main ref="scrollContainer" class="flex-1 scroll-container">
          <!-- Slide 1: å“ç‰Œæ•…äº‹ -->
          <section class="scroll-slide">
            <div class="h-full flex flex-col justify-end px-8 pb-32">
              <div class="space-y-6 text-left">
                <h2 class="text-4xl font-bold leading-tight">å“ç‰Œæ•…äº‹</h2>
                <div class="w-16 h-1 bg-white/80 rounded-full"></div>
                <p class="text-lg text-gray-300 leading-relaxed">
                  HealthWatch è¯ç”Ÿäºå¯¹å¥åº·ç”Ÿæ´»çš„æ·±åº¦æ€è€ƒã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œæ¯ä¸ªäººéƒ½åº”è¯¥æ‹¥æœ‰å±äºè‡ªå·±çš„å¥åº·åŠ©æ‰‹ã€‚
                </p>
                <div class="flex justify-between items-center pt-4 text-center">
                  <div>
                    <div class="text-3xl font-bold text-blue-400">500K+</div>
                    <div class="text-sm text-gray-400 mt-1">ç”¨æˆ·ä¿¡èµ–</div>
                  </div>
                  <div>
                    <div class="text-3xl font-bold text-green-400">24/7</div>
                    <div class="text-sm text-gray-400 mt-1">å¥åº·ç›‘æŠ¤</div>
                  </div>
                  <div>
                    <div class="text-3xl font-bold text-purple-400">AI</div>
                    <div class="text-sm text-gray-400 mt-1">æ™ºèƒ½åˆ†æ</div>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Slide 2: äº§å“æ¼”ç¤º -->
          <section class="scroll-slide">
            <div class="h-full flex flex-col justify-end px-8 pb-32">
              <div class="text-center space-y-6">
                <div class="text-8xl">âŒšï¸</div>
                <h2 class="text-4xl font-bold">HealthWatch Pro</h2>
                <p class="text-lg text-gray-300">
                  ä½“éªŒAIæŠ€æœ¯å¦‚ä½•é©æ–°æ‚¨çš„å¥åº·ç®¡ç†ã€‚
                </p>
                <div class="inline-block bg-white/10 text-white text-sm px-4 py-2 rounded-full border border-white/20">
                  äº§å“æ¼”ç¤ºè§†é¢‘ - 2:30
                </div>
              </div>
            </div>
          </section>

          <!-- Slide 3: äº§å“ç”Ÿæ€ -->
          <section class="scroll-slide">
            <div class="h-full flex flex-col justify-end px-8 pb-32">
              <div class="space-y-6 text-left">
                <h2 class="text-4xl font-bold leading-tight">ä¸€ä¸ªå®Œæ•´çš„<br>å¥åº·ç”Ÿæ€</h2>
                <div class="w-16 h-1 bg-white/80 rounded-full"></div>
                <div class="space-y-4 pt-2">
                  <div class="flex items-center space-x-4"><div class="w-8 h-8 flex-shrink-0 bg-blue-500/20 rounded-lg flex items-center justify-center">ğŸ“±</div><span>æ™ºèƒ½æ‰‹ç¯ - 24/7å¥åº·ç›‘æµ‹</span></div>
                  <div class="flex items-center space-x-4"><div class="w-8 h-8 flex-shrink-0 bg-purple-500/20 rounded-lg flex items-center justify-center">ğŸ¤–</div><span>AIåŠ©æ‰‹ - æ‚¨çš„ç§äººå¥åº·é¡¾é—®</span></div>
                  <div class="flex items-center space-x-4"><div class="w-8 h-8 flex-shrink-0 bg-green-500/20 rounded-lg flex items-center justify-center">ğŸ“Š</div><span>æ•°æ®åˆ†æ - æ·±åº¦å¥åº·æ´å¯Ÿ</span></div>
                  <div class="flex items-center space-x-4"><div class="w-8 h-8 flex-shrink-0 bg-orange-500/20 rounded-lg flex items-center justify-center">ğŸ›’</div><span>å¥åº·å•†åŸ - ç²¾é€‰å¥åº·äº§å“</span></div>
                </div>
              </div>
            </div>
          </section>

          <!-- Slide 4: å¼€å§‹ä½“éªŒ -->
          <section class="scroll-slide">
            <div class="h-full flex flex-col justify-end px-8 pb-32">
              <div class="text-center space-y-8">
                 <div class="text-8xl">ğŸš€</div>
                <h2 class="text-4xl font-bold">å‡†å¤‡å¥½å¼€å¯<br>æ‚¨çš„å¥åº·ä¹‹æ—…äº†å—ï¼Ÿ</h2>
                <p class="text-lg text-gray-300">
                  ç«‹å³è¿›å…¥å¥åº·å•†åŸï¼Œå‘ç°æ›´å¤šç²¾å½©ã€‚
                </p>
                <button @click="startExperience" class="w-full bg-white text-black font-semibold py-4 rounded-2xl hover:bg-gray-200 transition-all text-lg active:scale-95">
                  å¼€å§‹ä½“éªŒ
                </button>
              </div>
            </div>
          </section>
        </main>
        
        <!-- åˆ†é¡µæŒ‡ç¤ºå™¨ -->
        <div class="absolute bottom-16 left-0 right-0 flex justify-center items-center space-x-2 z-30">
          <button v-for="i in 4" :key="i" @click="scrollToSlide(i - 1)"
               :class="['h-2 rounded-full transition-all duration-500 ease-out', activeSlide === i - 1 ? 'w-5 bg-white' : 'w-2 bg-white/40']">
          </button>
        </div>
      </div>
    </div>
  </PhoneFrame>
</template>

<script setup>
import { ref, onMounted, onUnmounted } from 'vue'
import { useRouter } from 'vue-router'
import PhoneFrame from '../components/PhoneFrame.vue'

const router = useRouter()
const scrollContainer = ref(null)
const activeSlide = ref(0)
let scrollTimeout = null

// ç™»å½•
const handleLogin = () => {
  router.push('/')
}

// å¼€å§‹ä½“éªŒ
const startExperience = () => {
  sessionStorage.setItem('tempLoginStatus', 'true')
  window.dispatchEvent(new Event('loginStatusChanged'))
  router.push('/home?show=mall')
}

const handleScroll = () => {
  if (!scrollContainer.value) return;
  // Debounce to avoid performance issues on rapid scroll
  clearTimeout(scrollTimeout);
  scrollTimeout = setTimeout(() => {
    const slideWidth = scrollContainer.value.clientWidth;
    const currentScroll = scrollContainer.value.scrollLeft;
    activeSlide.value = Math.round(currentScroll / slideWidth);
  }, 100);
}

const scrollToSlide = (index) => {
  if (scrollContainer.value) {
    const slideWidth = scrollContainer.value.clientWidth;
    scrollContainer.value.scrollTo({
      left: slideWidth * index,
      behavior: 'smooth'
    })
  }
}

onMounted(() => {
  scrollContainer.value?.addEventListener('scroll', handleScroll, { passive: true })
})

onUnmounted(() => {
  scrollContainer.value?.removeEventListener('scroll', handleScroll)
  clearTimeout(scrollTimeout)
})
</script>

<style scoped>
.scroll-container {
  display: flex;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  -webkit-overflow-scrolling: touch;
}

.scroll-container::-webkit-scrollbar {
  display: none;
}

.scroll-slide {
  flex: 0 0 100%;
  width: 100%;
  scroll-snap-align: start;
  position: relative;
  overflow: hidden; /* Prevent content overflow issues on slides */
}

/* å®‰å…¨åŒºåŸŸé€‚é… */
.pb-safe-bottom {
  padding-bottom: max(1.5rem, env(safe-area-inset-bottom));
}
</style> 